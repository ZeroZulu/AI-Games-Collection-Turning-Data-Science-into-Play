<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>⚡ TIC-TAC-TOE NEURAL NET ⚡</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Roboto+Mono:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --neon-green: #00ff41;
            --neon-cyan: #00ffff;
            --neon-pink: #ff00ff;
            --neon-yellow: #ffff00;
            --dark-bg: #0a0e27;
            --darker-bg: #050810;
            --terminal-green: #33ff33;
            --warning-red: #ff3333;
            --grid-color: #1a2332;
        }
        
        body {
            font-family: 'Roboto Mono', monospace;
            background: var(--darker-bg);
            color: var(--neon-green);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        /* Matrix rain background */
        #matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0.15;
            pointer-events: none;
        }
        
        /* Scanlines effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(0, 255, 65, 0.03) 2px,
                rgba(0, 255, 65, 0.03) 4px
            );
            pointer-events: none;
            z-index: 1;
            animation: scanlines 8s linear infinite;
        }
        
        @keyframes scanlines {
            0% { transform: translateY(0); }
            100% { transform: translateY(10px); }
        }
        
        .container {
            position: relative;
            z-index: 2;
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header with glitch effect */
        .header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }
        
        h1 {
            font-family: 'Press Start+2P', cursive;
            font-size: 2em;
            color: var(--neon-green);
            text-shadow: 
                0 0 10px var(--neon-green),
                0 0 20px var(--neon-green),
                0 0 30px var(--neon-green);
            animation: flicker 3s infinite alternate;
            margin-bottom: 15px;
            letter-spacing: 2px;
        }
        
        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.95; }
            60% { opacity: 1; }
            62% { opacity: 0.98; }
            64% { opacity: 1; }
        }
        
        .subtitle {
            font-size: 1.1em;
            color: var(--neon-cyan);
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 0 0 10px var(--neon-cyan);
        }
        
        .terminal-header {
            background: linear-gradient(135deg, #1a2332 0%, #0f1722 100%);
            border: 2px solid var(--neon-green);
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            box-shadow: 
                0 0 20px rgba(0, 255, 65, 0.3),
                inset 0 0 20px rgba(0, 255, 65, 0.05);
            position: relative;
            overflow: hidden;
        }
        
        .terminal-header::before {
            content: '> SYSTEM ONLINE _ NEURAL NETWORK ACTIVE';
            display: block;
            font-size: 0.9em;
            color: var(--neon-green);
            margin-bottom: 10px;
            animation: typing 4s steps(40) infinite;
        }
        
        @keyframes typing {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-around;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .stat-chip {
            background: rgba(0, 255, 65, 0.1);
            border: 1px solid var(--neon-green);
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 0.85em;
            text-transform: uppercase;
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.2);
            transition: all 0.3s;
        }
        
        .stat-chip:hover {
            background: rgba(0, 255, 65, 0.2);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.4);
            transform: scale(1.05);
        }
        
        .stat-chip span {
            color: var(--neon-cyan);
            font-weight: bold;
            margin-left: 8px;
        }
        
        /* Main game layout */
        .game-grid {
            display: grid;
            grid-template-columns: 400px 1fr 350px;
            gap: 20px;
            margin: 20px 0;
        }
        
        /* Game board section */
        .game-section {
            background: linear-gradient(135deg, #1a2332 0%, #0f1722 100%);
            border: 2px solid var(--neon-cyan);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 
                0 0 30px rgba(0, 255, 255, 0.3),
                inset 0 0 30px rgba(0, 255, 255, 0.05);
            position: relative;
        }
        
        .game-section::before {
            content: '[GAME INTERFACE]';
            position: absolute;
            top: -12px;
            left: 20px;
            background: var(--darker-bg);
            padding: 0 10px;
            font-size: 0.8em;
            color: var(--neon-cyan);
            font-weight: bold;
        }
        
        .status-display {
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid var(--neon-cyan);
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 6px;
            position: relative;
            overflow: hidden;
        }
        
        .status-display::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.3), transparent);
            animation: scan 3s infinite;
        }
        
        @keyframes scan {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .status-text {
            font-size: 1.3em;
            font-weight: bold;
            color: var(--neon-cyan);
            text-shadow: 0 0 10px var(--neon-cyan);
            text-transform: uppercase;
            position: relative;
            z-index: 1;
        }
        
        .player-indicator {
            font-size: 0.8em;
            color: var(--neon-green);
            margin-top: 5px;
        }
        
        /* AI thinking */
        .ai-thinking {
            display: none;
            text-align: center;
            margin: 15px 0;
            font-size: 0.9em;
            color: var(--neon-yellow);
        }
        
        .ai-thinking.active {
            display: block;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .ai-thinking::before {
            content: '[ ';
            color: var(--neon-green);
        }
        
        .ai-thinking::after {
            content: ' ]';
            color: var(--neon-green);
        }
        
        /* Game board */
        .board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin: 20px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--grid-color);
            border-radius: 8px;
            box-shadow: inset 0 0 30px rgba(0, 255, 65, 0.1);
        }
        
        .cell {
            aspect-ratio: 1;
            background: linear-gradient(135deg, #1a2332 0%, #0f1722 100%);
            border: 2px solid var(--neon-green);
            border-radius: 6px;
            font-family: 'Press Start+2P', cursive;
            font-size: 2.5em;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .cell::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at center, var(--neon-green), transparent 70%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .cell:hover:not(:disabled)::before {
            opacity: 0.2;
        }
        
        .cell:hover:not(:disabled) {
            border-color: var(--neon-cyan);
            box-shadow: 
                0 0 20px rgba(0, 255, 255, 0.5),
                inset 0 0 20px rgba(0, 255, 255, 0.1);
            transform: scale(1.05) translateY(-3px);
        }
        
        .cell:active:not(:disabled) {
            transform: scale(0.98);
        }
        
        .cell:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }
        
        .cell.x {
            color: var(--neon-cyan);
            text-shadow: 
                0 0 10px var(--neon-cyan),
                0 0 20px var(--neon-cyan),
                0 0 30px var(--neon-cyan);
            animation: neonPop 0.4s ease-out;
        }
        
        .cell.o {
            color: var(--neon-pink);
            text-shadow: 
                0 0 10px var(--neon-pink),
                0 0 20px var(--neon-pink),
                0 0 30px var(--neon-pink);
            animation: neonPop 0.4s ease-out;
        }
        
        @keyframes neonPop {
            0% { 
                transform: scale(0) rotate(-180deg);
                opacity: 0;
            }
            50% { 
                transform: scale(1.3) rotate(10deg);
            }
            100% { 
                transform: scale(1) rotate(0);
                opacity: 1;
            }
        }
        
        .cell.winning {
            animation: winPulse 0.6s infinite, glow 0.6s infinite;
            border-color: var(--neon-yellow);
        }
        
        @keyframes winPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes glow {
            0%, 100% { 
                box-shadow: 0 0 20px var(--neon-yellow),
                           0 0 40px var(--neon-yellow);
            }
            50% { 
                box-shadow: 0 0 30px var(--neon-yellow),
                           0 0 60px var(--neon-yellow);
            }
        }
        
        /* Controls */
        .controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        button {
            flex: 1;
            background: linear-gradient(135deg, var(--neon-green), #00aa33);
            color: var(--darker-bg);
            border: 2px solid var(--neon-green);
            padding: 12px 20px;
            font-family: 'Press Start+2P', cursive;
            font-size: 0.7em;
            cursor: pointer;
            border-radius: 4px;
            text-transform: uppercase;
            transition: all 0.3s;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        button:hover::before {
            width: 300px;
            height: 300px;
        }
        
        button:hover {
            box-shadow: 0 0 30px rgba(0, 255, 65, 0.6);
            transform: translateY(-2px);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button.secondary {
            background: linear-gradient(135deg, var(--neon-cyan), #0088aa);
            border-color: var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }
        
        button.secondary:hover {
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.6);
        }
        
        /* Visualization panel */
        .viz-panel {
            background: linear-gradient(135deg, #1a2332 0%, #0f1722 100%);
            border: 2px solid var(--neon-pink);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 
                0 0 30px rgba(255, 0, 255, 0.3),
                inset 0 0 30px rgba(255, 0, 255, 0.05);
            position: relative;
        }
        
        .viz-panel::before {
            content: '[NEURAL ACTIVITY]';
            position: absolute;
            top: -12px;
            left: 20px;
            background: var(--darker-bg);
            padding: 0 10px;
            font-size: 0.8em;
            color: var(--neon-pink);
            font-weight: bold;
        }
        
        .panel-title {
            color: var(--neon-pink);
            font-family: 'Press Start+2P', cursive;
            font-size: 0.9em;
            margin-bottom: 15px;
            text-shadow: 0 0 10px var(--neon-pink);
        }
        
        /* Live metrics */
        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }
        
        .metric-box {
            background: rgba(255, 0, 255, 0.1);
            border: 1px solid var(--neon-pink);
            padding: 12px;
            border-radius: 4px;
            text-align: center;
        }
        
        .metric-label {
            font-size: 0.7em;
            color: var(--neon-cyan);
            text-transform: uppercase;
            margin-bottom: 5px;
        }
        
        .metric-value {
            font-family: 'Press Start+2P', cursive;
            font-size: 1.2em;
            color: var(--neon-pink);
            text-shadow: 0 0 10px var(--neon-pink);
        }
        
        /* Algorithm visualization */
        .algo-viz {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--grid-color);
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            min-height: 180px;
            position: relative;
        }
        
        #algoCanvas {
            width: 100%;
            height: 180px;
            display: block;
        }
        
        /* Terminal log */
        .terminal-log {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid var(--neon-green);
            border-radius: 6px;
            padding: 12px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Roboto Mono', monospace;
            font-size: 0.75em;
            margin-top: 15px;
        }
        
        .terminal-log::before {
            content: '> SYSTEM.LOG';
            display: block;
            color: var(--neon-green);
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        .log-line {
            color: var(--terminal-green);
            margin: 3px 0;
            padding-left: 10px;
            animation: logAppear 0.3s ease-out;
        }
        
        @keyframes logAppear {
            from { 
                opacity: 0;
                transform: translateX(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .log-line::before {
            content: '> ';
            color: var(--neon-cyan);
        }
        
        .log-time {
            color: #666;
        }
        
        .log-score {
            color: var(--neon-yellow);
            font-weight: bold;
        }
        
        /* Settings panel */
        .settings-panel {
            background: linear-gradient(135deg, #1a2332 0%, #0f1722 100%);
            border: 2px solid var(--neon-yellow);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 
                0 0 30px rgba(255, 255, 0, 0.3),
                inset 0 0 30px rgba(255, 255, 0, 0.05);
            position: relative;
        }
        
        .settings-panel::before {
            content: '[CONFIG]';
            position: absolute;
            top: -12px;
            left: 20px;
            background: var(--darker-bg);
            padding: 0 10px;
            font-size: 0.8em;
            color: var(--neon-yellow);
            font-weight: bold;
        }
        
        .config-item {
            background: rgba(255, 255, 0, 0.05);
            border: 1px solid var(--neon-yellow);
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }
        
        .config-item:hover {
            background: rgba(255, 255, 0, 0.1);
            border-color: var(--neon-green);
            box-shadow: 0 0 15px rgba(255, 255, 0, 0.2);
        }
        
        .config-label {
            font-size: 0.85em;
            color: var(--neon-yellow);
            text-transform: uppercase;
        }
        
        /* Pixel toggle switch */
        .pixel-toggle {
            width: 60px;
            height: 28px;
            background: var(--grid-color);
            border: 2px solid var(--neon-yellow);
            border-radius: 4px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .pixel-toggle::before {
            content: 'OFF';
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.6em;
            color: #666;
            font-weight: bold;
        }
        
        .pixel-toggle.active {
            background: var(--neon-green);
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.5);
        }
        
        .pixel-toggle.active::before {
            content: 'ON';
            left: 5px;
            right: auto;
            color: var(--darker-bg);
        }
        
        .toggle-knob {
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--neon-yellow);
            border: 2px solid var(--darker-bg);
            top: 2px;
            left: 2px;
            transition: all 0.3s;
            box-shadow: 0 0 10px var(--neon-yellow);
        }
        
        .pixel-toggle.active .toggle-knob {
            left: calc(100% - 24px);
        }
        
        /* Score board */
        .scoreboard {
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid var(--neon-green);
            border-radius: 6px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .scoreboard-title {
            color: var(--neon-green);
            font-family: 'Press Start+2P', cursive;
            font-size: 0.8em;
            margin-bottom: 12px;
            text-shadow: 0 0 10px var(--neon-green);
        }
        
        .score-row {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 8px;
            background: rgba(0, 255, 65, 0.05);
            border-radius: 3px;
        }
        
        .score-label {
            color: var(--neon-cyan);
            font-size: 0.85em;
        }
        
        .score-value {
            color: var(--neon-pink);
            font-weight: bold;
            font-family: 'Press Start+2P', cursive;
            font-size: 0.9em;
        }
        
        /* Particles */
        .particle-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }
        
        .particle-dot {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--neon-green);
            box-shadow: 0 0 3px var(--neon-green);
            animation: float-particle 15s linear infinite;
        }
        
        @keyframes float-particle {
            0% {
                transform: translateY(0) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) translateX(50px);
                opacity: 0;
            }
        }
        
        /* Win explosion effect */
        @keyframes explode {
            to {
                transform: translate(var(--tx), var(--ty)) scale(0);
                opacity: 0;
            }
        }
        
        .explosion-particle {
            position: fixed;
            width: 8px;
            height: 8px;
            background: var(--neon-yellow);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--neon-yellow);
            pointer-events: none;
            animation: explode 1s ease-out forwards;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--grid-color);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--neon-green);
            box-shadow: 0 0 10px var(--neon-green);
        }
        
        /* Responsive */
        @media (max-width: 1400px) {
            .game-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.5em;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 1.2em;
            }
            
            .cell {
                font-size: 2em;
            }
            
            button {
                font-size: 0.6em;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Matrix rain background -->
    <canvas id="matrix-bg"></canvas>
    
    <!-- Particle dots -->
    <div class="particle-container" id="particles"></div>

    <div class="container">
        <div class="header">
            <h1>⚡ TIC-TAC-TOE NEURAL NET ⚡</h1>
            <p class="subtitle">» Minimax Algorithm • Alpha-Beta Pruning «</p>
        </div>

        <div class="terminal-header">
            <div class="stats-bar">
                <div class="stat-chip">GAMES: <span id="headerGames">0</span></div>
                <div class="stat-chip">WIN RATE: <span id="headerWinRate">0%</span></div>
                <div class="stat-chip">AVG COMPUTE: <span id="headerCompute">0ms</span></div>
                <div class="stat-chip">STATES: <span id="headerStates">0</span></div>
            </div>
        </div>

        <div class="game-grid">
            <!-- Game Section -->
            <div class="game-section">
                <div class="status-display">
                    <div class="status-text" id="status">YOUR MOVE</div>
                    <div class="player-indicator">» PLAYER: X | AI: O «</div>
                </div>

                <div class="ai-thinking" id="thinking">
                    AI COMPUTING OPTIMAL PATH...
                </div>

                <div class="board" id="board">
                    <button class="cell" data-index="0"></button>
                    <button class="cell" data-index="1"></button>
                    <button class="cell" data-index="2"></button>
                    <button class="cell" data-index="3"></button>
                    <button class="cell" data-index="4"></button>
                    <button class="cell" data-index="5"></button>
                    <button class="cell" data-index="6"></button>
                    <button class="cell" data-index="7"></button>
                    <button class="cell" data-index="8"></button>
                </div>

                <div class="controls">
                    <button onclick="resetGame()">⟳ RESET</button>
                    <button class="secondary" onclick="clearStats()">⌫ CLEAR</button>
                </div>
            </div>

            <!-- Visualization Panel -->
            <div class="viz-panel">
                <h3 class="panel-title">» ALGORITHM VIZ</h3>

                <div class="metrics-grid">
                    <div class="metric-box">
                        <div class="metric-label">Win Rate</div>
                        <div class="metric-value" id="winRate">0%</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-label">Games</div>
                        <div class="metric-value" id="gamesCount">0</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-label">Compute</div>
                        <div class="metric-value" id="computeTime">0ms</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-label">States</div>
                        <div class="metric-value" id="statesVal">0</div>
                    </div>
                </div>

                <div class="algo-viz">
                    <canvas id="algoCanvas"></canvas>
                </div>

                <div class="terminal-log" id="terminalLog">
                    <div style="color: #666; text-align: center;">
                        >> AWAITING AI MOVE...
                    </div>
                </div>
            </div>

            <!-- Settings Panel -->
            <div class="settings-panel">
                <h3 class="panel-title">» SETTINGS</h3>

                <div class="config-item">
                    <span class="config-label">PRUNING</span>
                    <div class="pixel-toggle active" id="pruningToggle" onclick="togglePruning()">
                        <div class="toggle-knob"></div>
                    </div>
                </div>

                <div class="config-item">
                    <span class="config-label">LEARNING</span>
                    <div class="pixel-toggle" id="learningToggle" onclick="toggleLearning()">
                        <div class="toggle-knob"></div>
                    </div>
                </div>

                <div class="config-item">
                    <span class="config-label">VISUALIZATION</span>
                    <div class="pixel-toggle active" id="vizToggle" onclick="toggleViz()">
                        <div class="toggle-knob"></div>
                    </div>
                </div>

                <div class="scoreboard">
                    <div class="scoreboard-title">» SCOREBOARD</div>
                    <div class="score-row">
                        <span class="score-label">AI WINS</span>
                        <span class="score-value" id="aiWins">0</span>
                    </div>
                    <div class="score-row">
                        <span class="score-label">PLAYER WINS</span>
                        <span class="score-value" id="playerWins">0</span>
                    </div>
                    <div class="score-row">
                        <span class="score-label">DRAWS</span>
                        <span class="score-value" id="draws">0</span>
                    </div>
                    <div class="score-row">
                        <span class="score-label">TOTAL STATES</span>
                        <span class="score-value" id="totalStates">0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Matrix rain effect
        const matrixCanvas = document.getElementById('matrix-bg');
        const matrixCtx = matrixCanvas.getContext('2d');
        matrixCanvas.width = window.innerWidth;
        matrixCanvas.height = window.innerHeight;

        const matrixChars = '01アイウエオカキクケコサシスセソタチツテトナニヌネノ';
        const fontSize = 14;
        const columns = matrixCanvas.width / fontSize;
        const drops = Array(Math.floor(columns)).fill(1);

        function drawMatrix() {
            matrixCtx.fillStyle = 'rgba(5, 8, 16, 0.05)';
            matrixCtx.fillRect(0, 0, matrixCanvas.width, matrixCanvas.height);
            
            matrixCtx.fillStyle = '#00ff41';
            matrixCtx.font = fontSize + 'px monospace';

            for (let i = 0; i < drops.length; i++) {
                const text = matrixChars[Math.floor(Math.random() * matrixChars.length)];
                matrixCtx.fillText(text, i * fontSize, drops[i] * fontSize);

                if (drops[i] * fontSize > matrixCanvas.height && Math.random() > 0.975) {
                    drops[i] = 0;
                }
                drops[i]++;
            }
        }

        setInterval(drawMatrix, 50);

        // Create floating particles
        const particlesContainer = document.getElementById('particles');
        for (let i = 0; i < 30; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle-dot';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 15 + 's';
            particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
            particlesContainer.appendChild(particle);
        }

        // Game logic
        let board = ['', '', '', '', '', '', '', '', ''];
        let currentPlayer = 'X';
        let gameActive = true;
        let usePruning = true;
        let learningMode = false;
        let showViz = true;

        let stats = {
            games: 0,
            aiWins: 0,
            playerWins: 0,
            draws: 0,
            totalStates: 0,
            totalTime: 0,
            decisions: 0
        };

        const winPatterns = [
            [0, 1, 2], [3, 4, 5], [6, 7, 8],
            [0, 3, 6], [1, 4, 7], [2, 5, 8],
            [0, 4, 8], [2, 4, 6]
        ];

        document.addEventListener('DOMContentLoaded', () => {
            const cells = document.querySelectorAll('.cell');
            cells.forEach(cell => {
                cell.addEventListener('click', handleCellClick);
            });
            loadStats();
            drawAlgoViz();
        });

        function handleCellClick(e) {
            const index = parseInt(e.target.dataset.index);
            
            if (board[index] !== '' || !gameActive || currentPlayer !== 'X') {
                return;
            }

            makeMove(index, 'X');
            
            if (gameActive) {
                document.getElementById('thinking').classList.add('active');
                setTimeout(() => {
                    aiMove();
                    document.getElementById('thinking').classList.remove('active');
                }, 400);
            }
        }

        function makeMove(index, player) {
            board[index] = player;
            const cell = document.querySelectorAll('.cell')[index];
            cell.textContent = player;
            cell.classList.add(player.toLowerCase());
            cell.disabled = true;

            if (checkWinner(board, player)) {
                endGame(player);
            } else if (board.every(cell => cell !== '')) {
                endGame('draw');
            } else {
                currentPlayer = player === 'X' ? 'O' : 'X';
                updateStatus();
            }
        }

        function aiMove() {
            const startTime = performance.now();
            let statesEvaluated = 0;

            function minimax(boardState, player, depth, alpha, beta) {
                statesEvaluated++;

                if (checkWinner(boardState, 'X')) return { score: -10 + depth };
                if (checkWinner(boardState, 'O')) return { score: 10 - depth };
                if (boardState.every(cell => cell !== '')) return { score: 0 };

                const availableMoves = boardState.map((cell, idx) => cell === '' ? idx : null).filter(x => x !== null);
                let best = { score: player === 'O' ? -Infinity : Infinity };

                for (let move of availableMoves) {
                    const newBoard = [...boardState];
                    newBoard[move] = player;

                    const result = minimax(newBoard, player === 'O' ? 'X' : 'O', depth + 1, alpha, beta);

                    if (player === 'O') {
                        if (result.score > best.score) {
                            best = { score: result.score, index: move };
                        }
                        alpha = Math.max(alpha, result.score);
                    } else {
                        if (result.score < best.score) {
                            best = { score: result.score, index: move };
                        }
                        beta = Math.min(beta, result.score);
                    }

                    if (usePruning && beta <= alpha) break;
                }

                return best;
            }

            const result = minimax(board, 'O', 0, -Infinity, Infinity);
            const computeTime = performance.now() - startTime;

            stats.totalStates += statesEvaluated;
            stats.totalTime += computeTime;
            stats.decisions++;

            addLog(`MOVE[${result.index}] SCORE[${result.score}] STATES[${statesEvaluated}] TIME[${computeTime.toFixed(1)}ms]`);

            if (showViz) {
                visualizeAlgo(result.index, statesEvaluated);
            }

            updateLiveMetrics();
            makeMove(result.index, 'O');
        }

        function checkWinner(boardState, player) {
            return winPatterns.some(pattern =>
                pattern.every(index => boardState[index] === player)
            );
        }

        function endGame(winner) {
            gameActive = false;
            stats.games++;

            if (winner === 'X') {
                stats.playerWins++;
                document.getElementById('status').textContent = '⚡ PLAYER VICTORY ⚡';
                createExplosion();
            } else if (winner === 'O') {
                stats.aiWins++;
                document.getElementById('status').textContent = '⚠ AI DOMINANCE ⚠';
            } else {
                stats.draws++;
                document.getElementById('status').textContent = '≈ DRAW ≈';
            }

            if (winner !== 'draw') {
                const winningPattern = winPatterns.find(pattern =>
                    pattern.every(index => board[index] === winner)
                );
                if (winningPattern) {
                    winningPattern.forEach(index => {
                        document.querySelectorAll('.cell')[index].classList.add('winning');
                    });
                }
            }

            updateStats();
            saveStats();

            document.querySelectorAll('.cell').forEach(cell => cell.disabled = true);
        }

        function resetGame() {
            board = ['', '', '', '', '', '', '', '', ''];
            currentPlayer = 'X';
            gameActive = true;

            document.querySelectorAll('.cell').forEach(cell => {
                cell.textContent = '';
                cell.classList.remove('x', 'o', 'winning');
                cell.disabled = false;
            });

            document.getElementById('status').textContent = 'YOUR MOVE';
            drawAlgoViz();
        }

        function updateStatus() {
            document.getElementById('status').textContent = 
                currentPlayer === 'X' ? 'YOUR MOVE' : 'AI PROCESSING...';
        }

        function updateStats() {
            document.getElementById('gamesCount').textContent = stats.games;
            document.getElementById('aiWins').textContent = stats.aiWins;
            document.getElementById('playerWins').textContent = stats.playerWins;
            document.getElementById('draws').textContent = stats.draws;

            const winRate = stats.games > 0 ? ((stats.aiWins / stats.games) * 100).toFixed(0) : 0;
            document.getElementById('winRate').textContent = winRate + '%';
            document.getElementById('headerWinRate').textContent = winRate + '%';
            document.getElementById('headerGames').textContent = stats.games;

            document.getElementById('totalStates').textContent = stats.totalStates.toLocaleString();
        }

        function updateLiveMetrics() {
            const avgStates = stats.decisions > 0 ? Math.round(stats.totalStates / stats.decisions) : 0;
            const avgTime = stats.decisions > 0 ? (stats.totalTime / stats.decisions).toFixed(1) : 0;

            document.getElementById('statesVal').textContent = avgStates.toLocaleString();
            document.getElementById('computeTime').textContent = avgTime + 'ms';
            document.getElementById('headerStates').textContent = avgStates.toLocaleString();
            document.getElementById('headerCompute').textContent = avgTime + 'ms';
        }

        function visualizeAlgo(selectedMove, states) {
            const canvas = document.getElementById('algoCanvas');
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = 180;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw grid background
            ctx.strokeStyle = 'rgba(0, 255, 65, 0.1)';
            ctx.lineWidth = 1;
            for (let i = 0; i < canvas.width; i += 20) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            
            // Draw root node
            ctx.fillStyle = '#00ffff';
            ctx.shadowBlur = 20;
            ctx.shadowColor = '#00ffff';
            ctx.beginPath();
            ctx.arc(canvas.width / 2, 40, 15, 0, 2 * Math.PI);
            ctx.fill();
            ctx.shadowBlur = 0;
            
            ctx.fillStyle = '#0a0e27';
            ctx.font = 'bold 12px monospace';
            ctx.textAlign = 'center';
            ctx.fillText('AI', canvas.width / 2, 45);
            
            // Draw branches
            const branches = Math.min(board.filter(c => c === '').length, 9);
            const spacing = (canvas.width - 60) / Math.max(branches, 1);
            
            ctx.strokeStyle = 'rgba(0, 255, 65, 0.3)';
            ctx.lineWidth = 2;
            
            for (let i = 0; i < branches; i++) {
                const x = 30 + i * spacing;
                
                // Line
                ctx.beginPath();
                ctx.moveTo(canvas.width / 2, 55);
                ctx.lineTo(x + 15, 130);
                ctx.stroke();
                
                // Node
                if (i === 0) {
                    ctx.fillStyle = '#ffff00';
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = '#ffff00';
                } else {
                    ctx.fillStyle = '#1a2332';
                    ctx.shadowBlur = 0;
                }
                
                ctx.beginPath();
                ctx.arc(x + 15, 140, 10, 0, 2 * Math.PI);
                ctx.fill();
                ctx.shadowBlur = 0;
                
                ctx.fillStyle = i === 0 ? '#0a0e27' : '#00ff41';
                ctx.font = 'bold 10px monospace';
                ctx.fillText(i.toString(), x + 15, 144);
            }
            
            // Stats
            ctx.fillStyle = '#00ffff';
            ctx.font = '11px monospace';
            ctx.textAlign = 'left';
            ctx.fillText(`EVALUATED: ${states} STATES`, 10, 170);
            ctx.fillText(`OPTIMAL: NODE[0]`, canvas.width - 150, 170);
        }

        function drawAlgoViz() {
            const canvas = document.getElementById('algoCanvas');
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = 180;
            
            ctx.fillStyle = 'rgba(0, 255, 65, 0.3)';
            ctx.font = '12px monospace';
            ctx.textAlign = 'center';
            ctx.fillText('>> AWAITING AI COMPUTATION <<', canvas.width / 2, 90);
        }

        function addLog(message) {
            const log = document.getElementById('terminalLog');
            const line = document.createElement('div');
            line.className = 'log-line';
            const time = new Date().toLocaleTimeString();
            line.innerHTML = `<span class="log-time">${time}</span> ${message}`;
            
            if (log.children.length === 1 && log.textContent.includes('AWAITING')) {
                log.innerHTML = '';
            }
            
            log.insertBefore(line, log.firstChild);
            
            while (log.children.length > 15) {
                log.removeChild(log.lastChild);
            }
        }

        function createExplosion() {
            const colors = ['#00ff41', '#00ffff', '#ff00ff', '#ffff00'];
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'explosion-particle';
                    particle.style.left = window.innerWidth / 2 + 'px';
                    particle.style.top = window.innerHeight / 2 + 'px';
                    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                    
                    const angle = (Math.PI * 2 * i) / 50;
                    const velocity = 100 + Math.random() * 200;
                    particle.style.setProperty('--tx', Math.cos(angle) * velocity + 'px');
                    particle.style.setProperty('--ty', Math.sin(angle) * velocity + 'px');
                    
                    document.body.appendChild(particle);
                    setTimeout(() => particle.remove(), 1000);
                }, i * 20);
            }
        }

        function togglePruning() {
            usePruning = !usePruning;
            document.getElementById('pruningToggle').classList.toggle('active');
            addLog(`ALPHA-BETA PRUNING: ${usePruning ? 'ENABLED' : 'DISABLED'}`);
        }

        function toggleLearning() {
            learningMode = !learningMode;
            document.getElementById('learningToggle').classList.toggle('active');
            addLog(`LEARNING MODE: ${learningMode ? 'ENABLED' : 'DISABLED'}`);
        }

        function toggleViz() {
            showViz = !showViz;
            document.getElementById('vizToggle').classList.toggle('active');
            addLog(`VISUALIZATION: ${showViz ? 'ENABLED' : 'DISABLED'}`);
        }

        function clearStats() {
            if (confirm('⚠ RESET ALL STATISTICS? ⚠')) {
                stats = {
                    games: 0,
                    aiWins: 0,
                    playerWins: 0,
                    draws: 0,
                    totalStates: 0,
                    totalTime: 0,
                    decisions: 0
                };
                updateStats();
                updateLiveMetrics();
                saveStats();
                document.getElementById('terminalLog').innerHTML = '<div class="log-line">SYSTEM RESET COMPLETE</div>';
            }
        }

        function saveStats() {
            localStorage.setItem('tictactoe_matrix_stats', JSON.stringify(stats));
        }

        function loadStats() {
            const saved = localStorage.getItem('tictactoe_matrix_stats');
            if (saved) {
                stats = JSON.parse(saved);
                updateStats();
                updateLiveMetrics();
            }
        }

        // Resize handler
        window.addEventListener('resize', () => {
            matrixCanvas.width = window.innerWidth;
            matrixCanvas.height = window.innerHeight;
        });
    </script>
</body>
</html>
